import java.util.ArrayList;

class Task {
    protected String description;
    protected boolean isDone;

    public Task(String description) {
        this.description = description;
        this.isDone = false;
    }

    public String getStatusIcon() {
        return (isDone ? "[X]" : "[ ]");
    }

    public void markAsDone() {
        this.isDone = true;
    }

    public void markAsNotDone() {
        this.isDone = false;
    }

    public String toString() {
        return getStatusIcon() + " " + description;
    }
}

class ToDos extends Task {
    public ToDos(String description) {
        super(description);
    }

    @Override
    public String toString() {
        return "[T]" + super.toString();
    }
}

class Deadline extends Task {
    protected String by;

    public Deadline(String description, String by) {
        super(description);
        this.by = by;
    }

    @Override
    public String toString() {
        return "[D]" + super.toString() + " (by: " + by + ")";
    }
}

class Events extends Task {
    protected String at;
    protected String to;

    public Events(String description, String at, String to) {
        super(description);
        this.at = at;
        this.to = to;
    }

    @Override
    public String toString() {
        return "[E]" + super.toString() + " (from: " + at + " to: " + to + ")";
    }
}

public class ChatterBox {

    public static void main(String[] args) {
        String botName = "ChatterBox";
        boolean chatting = true;

        ArrayList<Task> tasks = new ArrayList<Task>();

        System.out.println("        Hello! I'm " + botName);
        System.out.println("        What can I do for you?");

        while (chatting) {
            String userInput = System.console().readLine();
            if (userInput.equalsIgnoreCase("bye")) {
                chatting = false;
                break;
            } else if (userInput.equalsIgnoreCase("list")) {
                for (int i = 0; i < tasks.size(); i++) {
                    System.out.println("        " + (i + 1) + "." + tasks.get(i));
                }

            } else if (userInput.startsWith("mark")) {
                String[] parts = userInput.split(" ");
                int taskNumber = Integer.parseInt(parts[1]) - 1;// generated by github copilot to get the taskNumber
                Task index = tasks.get(taskNumber);
                index.markAsDone();
                System.out.println("        Nice! I've marked this task as done:");
                System.out.println("          " + tasks.get(taskNumber).toString());

            } else if (userInput.startsWith("unmark")) {
                String[] parts = userInput.split(" ");
                int taskNumber = Integer.parseInt(parts[1]) - 1; // generated by github copilot to get the taskNumber
                Task index = tasks.get(taskNumber);
                index.markAsNotDone();
                System.out.println("        OK, I've marked this task as not done yet:");
                System.out.println("          " + tasks.get(taskNumber).toString());

            } else if (userInput.startsWith("todo")) {
                String task = userInput.substring(userInput.indexOf(" ") + 1); // generated by github copilot to get the
                                                                               // task description

                ToDos newToDo = new ToDos(task);
                tasks.add(newToDo);
                System.out.println("        Got it. I've added this task:");
                System.out.println("          " + newToDo.toString());
                System.out.println("        Now you have " + tasks.size() + " tasks in the list.");
            } else if (userInput.startsWith("deadline")) {
                String[] parts = userInput.split("/by", 2);
                String firstPart = parts[0].trim();
                String task = firstPart.substring(firstPart.indexOf(" ") + 1);
                // System.err.println(task);
                String deadline = parts[1].trim();

                Deadline newDeadline = new Deadline(task, deadline);
                tasks.add(newDeadline);
                System.out.println("        Got it. I've added this task:");
                System.out.println("          " + newDeadline.toString());
                System.out.println("        Now you have " + tasks.size() + " tasks in the list.");
            } else if (userInput.startsWith("event")) {
                String[] parts = userInput.split("/to", 2); // generated by github copilot to get the task description
                String firstPart = parts[0].trim(); // generated by github copilot to get the task description
                String taskAndAt = firstPart.substring(firstPart.indexOf(" ") + 1); // generated by github copilot to
                                                                                    // get the task description
                String[] taskParts = taskAndAt.split("/from", 4); // generated by github copilot to get the task
                                                                  // description
                String task = taskParts[0].trim(); // generated by github copilot to get the task description
                String at = taskParts[1].trim(); // generated by github copilot to get the task description
                String to = parts[1].trim(); // generated by github copilot to get the task description

                Events newEvent = new Events(task, at, to);
                tasks.add(newEvent);
                System.out.println("        Got it. I've added this task:");
                System.out.println("          " + newEvent.toString());
                System.out.println("        Now you have " + tasks.size() + " tasks in the list.");
            }

            else {
                Task newTask = new Task(userInput);
                tasks.add(newTask);
                System.out.println("        added: " + userInput);
            }
        }
        System.out.println("        Bye. Hope to see you again soon!");
    }
}
